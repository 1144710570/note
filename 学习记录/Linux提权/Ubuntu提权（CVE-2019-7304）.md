## CVE-2019-7304复现 ##
- - -
- 前言
- 正文

### 前言 ###
- - -
今天tm的情人节，我还在复现漏洞真是太爽了


### 正文 ###
- - -
本次提权漏洞有以下Ubuntu版本受到影响：
```
Ubuntu 18.10

Ubuntu 18.04 LTS

Ubuntu 16.04 LTS

Ubuntu 14.04 LTS
```

提权漏洞的起因是：
由于 snapd API 中的错误，Ubuntu Linux 部分版本被发现有本地权限提升漏洞

<b>复现</b>
我的环境是：
```
Ubuntu version:16.04 LTS
snapd API version:2.34.2
```
![kB12w9.png](https://s2.ax1x.com/2019/02/14/kB12w9.png)

下载POC：[GitHub - initstring/dirty_sock: Ubuntu Linux privilege escalation exploit (CVE-2019-7304)](https://github.com/initstring/dirty_sock)
![kB1oQO.md.png](https://s2.ax1x.com/2019/02/14/kB1oQO.md.png)


第一个POC
先登录Ubuntu，https://login.ubuntu.com/
在本地生成秘钥：
```
ssh-keygen -t rsa -C "<you email>"
```
然后到./.ssh下把，id_rsa.pub（公钥）拷到你账户的ssh_key里面去
![kB14W6.png](https://s2.ax1x.com/2019/02/14/kB14W6.png)

本地执行第一个poc
![kB17Oe.md.png](https://s2.ax1x.com/2019/02/14/kB17Oe.md.png)

![kB1qwd.png](https://s2.ax1x.com/2019/02/14/kB1qwd.png)

如果出现,以下问题就是你没有安装ssh服务
![kB1vfP.md.png](https://s2.ax1x.com/2019/02/14/kB1vfP.md.png)

执行：apt-get install openssh-server 即可解决问题，然后再执行一次POC就ok

执行完POC后，sudo -i即可获取root权限
![kB3790.png](https://s2.ax1x.com/2019/02/14/kB3790.png)

第二个POC直接执行即可
![kB3qjU.png](https://s2.ax1x.com/2019/02/14/kB3qjU.png)

然后他会创建dirty_sock用户，密码也是dirty_sock，su dirty_sock输入密码，然后在sudo -i ,输入dirty_sock的密码，切换到root用户即可

![kB8S41.png](https://s2.ax1x.com/2019/02/14/kB8S41.png)


![kB899x.png](https://s2.ax1x.com/2019/02/14/kB899x.png)